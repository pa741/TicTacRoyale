(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{3874:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return o(284)}])},284:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return b}});var l=o(5893),t=o(7294),s=o(3977),r=o(9828);let n=(0,s.ZF)({apiKey:"AIzaSyA3FFetP5jviPliqNJPwnKFmZZ5HDDdteM",authDomain:"tictactoeroyale.firebaseapp.com",projectId:"tictactoeroyale",storageBucket:"tictactoeroyale.appspot.com",messagingSenderId:"913682554953",appId:"1:913682554953:web:48ce760d29a45cfdbc1f98",measurementId:"G-315YB5165C"}),c=(0,r.ad)(n);var d=o(7320),i=o.n(d),u=o(9332),m=o(1163),_=o(7632);function g(e){let a=i().square;return e.disabled&&(a+=" "+i().disabled),(0,l.jsxs)("div",{className:a,onClick:e.onClick,children:[(0,l.jsx)("div",{className:i().topwall,children:e.value}),(0,l.jsx)("div",{className:i().leftwall}),(0,l.jsx)("div",{className:i().rightwall})]})}function p(e){let a=a=>(0,l.jsx)(g,{disabled:e.disabled,value:e.squares[a],onClick:()=>e.onClick(a)});return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:i().boardRow,children:[a(0),a(1),a(2)]}),(0,l.jsxs)("div",{className:i().boardRow,children:[a(3),a(4),a(5)]}),(0,l.jsxs)("div",{className:i().boardRow,children:[a(6),a(7),a(8)]})]})}var b=()=>{let e=(0,m.useRouter)(),a=(0,u.useSearchParams)().get("room"),[o,s]=(0,t.useState)(null),[n,d]=(0,t.useState)([]),[g,b]=(0,t.useState)(!1),[f,h]=(0,t.useState)([]),[v,w]=(0,t.useState)(null),{asPath:N}=(0,m.useRouter)(),j=window.location.origin?window.location.origin:"",x="".concat(j).concat(N).indexOf("?room=")>-1,k=async()=>{if(null==o&&s((0,_.Z)()),console.log("ENTER GAME: "+a),a){console.log(c),E=(0,r.JU)(c,"rooms",a);var e=await (0,r.QT)(E);if(e.exists()){if(console.log("Document data:",e.data()),e.data().created<Date().valueOf()-36e5&&(0,r.pl)((0,r.JU)(c,"rooms",a),{players:[o],turn:o,board:["","","","","","","","",""],created:Date().valueOf()}),e.data().players.length>=2){console.log("ROOM FULL");return}let l=[...e.data().players,o];console.log("NEW PLAYERS: "+l),E=(0,r.pl)((0,r.JU)(c,"rooms",a),{players:l,turn:e.data().turn,board:e.data().board,created:e.data().created})}else console.log("No such document!"),E=(0,r.pl)((0,r.JU)(c,"rooms",a),{players:[o],turn:o,board:["","","","","","","","",""],created:Date().valueOf()});(0,r.cf)((0,r.JU)(c,"rooms",a),e=>{console.log("Current data: ",e.data()),d(e.data().board),b(e.data().turn===o),h(e.data().players)}),console.log(o)}};(0,t.useEffect)(()=>(x||e.push("/"),k(),()=>{}),[a]);var E,y=n.map((e,a)=>e===o?"X":""===e?"":"hover"===e?"hover":"O");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:i().background}),(0,l.jsx)("div",{className:i().container,children:(0,l.jsx)("div",{className:i().table,children:(0,l.jsx)(p,{disabled:!g,squares:y,onClick:g?e=>{if(console.log("CLICK: "+e),console.log(n[e]+" "+o),""!==n[e]&&"hover"!==n[e]){console.log("NOT EMPTY");return}if(null!==v){console.log("GAME OVER");return}let l=[...n];l[e]=o;let t=null;console.log("player:"+o),console.log("players:"+f),f.forEach(e=>{e!==o&&(t=e)}),(0,r.pl)((0,r.JU)(c,"rooms",a),{players:f,turn:t,board:l,created:Date().valueOf()})}:()=>{}})})})]})}},7320:function(e){e.exports={background:"game_background__jSE_j",home:"game_home__0teJX",homeForm:"game_homeForm__5VdkL",title:"game_title__QpmVW",container:"game_container__p2XiD",table:"game_table__5TOzb",square:"game_square__LDkB6",topwall:"game_topwall__Ckig1",disabled:"game_disabled__o4PVz",boardRow:"game_boardRow__GRdw3"}}},function(e){e.O(0,[16,202,774,888,179],function(){return e(e.s=3874)}),_N_E=e.O()}]);